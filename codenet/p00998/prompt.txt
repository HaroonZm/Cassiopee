Voici un énoncé de problème :

Problem I : RMQ
n
個の数字
a
0
,
a
1
, ... ,
a
n-1
と
q
が与えられる。
q
個のクエリーに対して適切な処理を行なって欲しい。
クエリーは以下の3種類の操作が存在する。
値のシフトを行う
l
と
r
のペアが与えられる。(
l
<
r
)
a
l
から
a
r
までの値を Circular Shiftさせる。
0 1 2 3 4 5 6 7 8 9
に対してl=2,r=5というクエリーが与えられたとする。
シフトを行った数字列は
0 1 5 2 3 4 6 7 8 9
となる。
最小値を求める
l
と
r
のペアが与えられる。(
l
≤
r
)
a
l
から
a
r
までの値の中で最小の値を求める。
値の更新
pos
と
val
のペアが与えられる。
a
pos
の値を
val
に更新する。
Input
入力は以下のフォーマットで与えられる。
n
q
a
0
a
1
.
.
.
a
n-1
x
1
y
1
z
1
x
2
y
2
z
2
.
.
.
x
q
y
q
z
q
x
i
= 0
なら、シフトのクエリーを表す。このとき、
l = y
i
,
r = z
i
とする。
x
i
= 1
なら、最小値を求めるクエリーを表す。このとき、
l = y
i
,
r = z
i
とする。
x
i
= 2
なら、値を更新するクエリーを表す。このとき、
pos = y
i
,
val = z
i
とする。
入力は以下の制約を満たす
1 ≤
n , q
≤ 200,000
0 ≤
a
i
≤ 10,000,000
値を更新するクエリーについて、0 ≤
val
≤ 10,000,000
Output
クエリーとして
x
i
= 1
が与えられたときに、答えの値を１行に出力せよ。
Sample Input 1
10 3
0
1
2
3
4
5
6
7
8
9
1 5 7
0 2 5
1 5 7
Sample Output 1
5
4
Sample Input 2
10 10
289383
930886
692777
636915
747793
238335
885386
760492
516649
641421
2 7 368690
1 3 6
0 2 6
1 1 8
0 2 9
2 2 665123
1 5 9
0 2 8
2 7 961393
1 1 2
Sample Output 2
238335
238335
238335
368690

Voici un énoncé de problème :

Score :
100
points
Problem Statement
You are given an array
a_0, a_1, ..., a_{N-1}
of length
N
. Process
Q
queries of the following types.
The type of
i
-th query is represented by
T_i
.
T_i=1
: You are given two integers
X_i,V_i
. Replace the value of
A_{X_i}
with
V_i
.
T_i=2
: You are given two integers
L_i,R_i
. Calculate the maximum value among
A_{L_i},A_{L_i+1},\cdots,A_{R_i}
.
T_i=3
: You are given two integers
X_i,V_i
. Calculate the minimum
j
such that
X_i \leq j \leq N, V_i \leq A_j
. If there is no such
j
, answer
j=N+1
instead.
Constraints
1 \leq N \leq 2 \times 10^5
0 \leq A_i \leq 10^9
1 \leq Q \leq 2 \times 10^5
1 \leq T_i \leq 3
1 \leq X_i \leq N
,
0 \leq V_i \leq 10^9
(
T_i=1,3
)
1 \leq L_i \leq R_i \leq N
(
T_i=2
)
All values in Input are integer.
Input
Input is given from Standard Input in the following format:
N
Q
A_1
A_2
\cdots
A_N
First query
Second query
\vdots
Q
-th query
Each query is given in the following format:
If
T_i=1,3
,
T_i
X_i
V_i
If
T_i=2
,
T_i
L_i
R_i
Output
For each query with
T_i=2, 3
, print the answer.
Sample Input 1
5 5
1 2 3 2 1
2 1 5
3 2 3
1 3 1
2 2 4
3 1 3
Sample Output 1
3
3
2
6
First query: Print
3
, which is the maximum of
(A_1,A_2,A_3,A_4,A_5)=(1,2,3,2,1)
.
Second query: Since
3>A_2
,
j=2
does not satisfy the condition．Since
3 \leq A_3
, print
j=3
.
Third query: Replace the value of
A_3
with
1
. It becomes
A=(1,2,1,2,1)
.
Fourth query: Print
2
, which is the maximum of
(A_2,A_3,A_4)=(2,1,2)
.
Fifth query: Since there is no
j
that satisfies the condition, print
j=N+1=6
.

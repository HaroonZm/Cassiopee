Voici un énoncé de problème :

Score :
1800
points
Problem Statement
There is a tree
T
with
N
vertices, numbered
1
through
N
.
For each
1 ≤ i ≤ N - 1
, the
i
-th edge connects vertices
a_i
and
b_i
.
Snuke is constructing a directed graph
T'
by arbitrarily assigning direction to each edge in
T
. (There are
2^{N - 1}
different ways to construct
T'
.)
For a fixed
T'
, we will define
d(s,\ t)
for each
1 ≤ s,\ t ≤ N
, as follows:
d(s,\ t) =
(The number of edges that must be traversed against the assigned direction when traveling from vertex
s
to vertex
t
)
In particular,
d(s,\ s) = 0
for each
1 ≤ s ≤ N
.
Also note that, in general,
d(s,\ t) ≠ d(t,\ s)
.
We will further define
D
as the following:
Snuke is constructing
T'
so that
D
will be the minimum possible value.
How many different ways are there to construct
T'
so that
D
will be the minimum possible value, modulo
10^9 + 7
?
Constraints
2 ≤ N ≤ 1000
1 ≤ a_i,\ b_i ≤ N
The given graph is a tree.
Input
The input is given from Standard Input in the following format:
N
a_1
b_1
a_2
b_2
:
a_{N - 1}
b_{N - 1}
Output
Print the number of the different ways to construct
T'
so that
D
will be the minimum possible value, modulo
10^9 + 7
.
Sample Input 1
4
1 2
1 3
1 4
Sample Output 1
2
The minimum possible value for
D
is
1
.
There are two ways to construct
T'
to achieve this value, as shown in the following figure:
Sample Input 2
4
1 2
2 3
3 4
Sample Output 2
6
The minimum possible value for
D
is
2
.
There are six ways to construct
T'
to achieve this value, as shown in the following figure:
Sample Input 3
6
1 2
1 3
1 4
2 5
2 6
Sample Output 3
14
Sample Input 4
10
2 4
2 5
8 3
10 7
1 6
2 8
9 5
8 6
10 6
Sample Output 4
102

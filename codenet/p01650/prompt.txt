Voici un énoncé de problème :

Problem Statement
There is a maze which can be described as a
W \times H
grid.
The upper-left cell is denoted as (1, 1), and the lower-right cell is
(W, H)
.
You are now at the cell (1, 1) and have to go to the cell
(W, H)
.
However, you can only move to the right adjacent cell or to the lower adjacent cell.
The following figure is an example of a maze.
...#......
a###.#####
.bc...A...
##.#C#d#.#
.#B#.#.###
.#...#e.D.
.#A..###.#
..e.c#..E.
####d###.#
#....#.#.#
##E...d.C.
In the maze, some cells are free (denoted by
.
) and some cells are occupied by rocks (denoted by
#
), where you cannot enter.
Also there are jewels (denoted by lowercase alphabets) in some of the free cells and holes to place jewels (denoted by uppercase alphabets).
Different alphabets correspond to different types of jewels, i.e. a cell denoted by
a
contains a jewel of type A, and a cell denoted by
A
contains a hole to place a jewel of type A.
It is said that, when we place a jewel to a corresponding hole, something happy will happen.
At the cells with jewels, you can choose whether you pick a jewel or not.
Similarly, at the cells with holes, you can choose whether you place a jewel you have or not.
Initially you do not have any jewels.
You have a very big bag, so you can bring arbitrarily many jewels.
However, your bag is a stack, that is, you can only place the jewel that you picked up last.
On the way from cell (1, 1) to cell
(W, H)
, how many jewels can you place to correct holes?
Input
The input contains a sequence of datasets.
The end of the input is indicated by a line containing two zeroes.
Each dataset is formatted as follows.
H
W
C_{11}
C_{12}
...
C_{1W}
C_{21}
C_{22}
...
C_{2W}
...
C_{H1}
C_{H2}
...
C_{HW}
Here,
H
and
W
are the height and width of the grid.
You may assume
1 \leq W, H \leq 50
.
The rest of the datasets consists of
H
lines, each of which is composed of
W
letters.
Each letter
C_{ij}
specifies the type of the cell
(i, j)
as described before.
It is guaranteed that
C_{11}
and
C_{WH}
are never
#
.
You may also assume that each lowercase or uppercase alphabet appear at most 10 times in each dataset.
Output
For each dataset, output the maximum number of jewels that you can place to corresponding holes.
If you cannot reach the cell
(W, H)
, output -1.
Sample Input
3 3
ac#
b#C
.BA
3 3
aaZ
a#Z
aZZ
3 3
..#
.#.
#..
1 50
abcdefghijklmnopqrstuvwxyYXWVUTSRQPONMLKJIHGFEDCBA
1 50
aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyY
1 50
abcdefghijklmnopqrstuvwxyABCDEFGHIJKLMNOPQRSTUVWXY
1 50
aaaaaaaaaabbbbbbbbbbcccccCCCCCBBBBBBBBBBAAAAAAAAAA
10 10
...#......
a###.#####
.bc...A...
##.#C#d#.#
.#B#.#.###
.#...#e.D.
.#A..###.#
..e.c#..E.
####d###.#
##E...D.C.
0 0
Output for the Sample Input
2
0
-1
25
25
1
25
4

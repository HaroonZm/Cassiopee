2025-06-04 23:14:06,290 - INFO - Démarrage du diagnostic sur le modèle: .\models\unet_Tiles_64x64_best_e30_b8_acc05962_20250604_214308.pth
2025-06-04 23:14:06,291 - INFO - Données: .\TILES\Tiles_64x64\
2025-06-04 23:14:06,291 - INFO - Dispositif: cpu
2025-06-04 23:14:06,529 - INFO - Modèle chargé avec succès
2025-06-04 23:14:06,529 - INFO - Analyse des poids du modèle...
2025-06-04 23:14:06,571 - INFO - Couche enc1.0.weight: mean=0.000197, std=0.058638, min=-0.194719, max=0.170257, near_zero=0.00%
2025-06-04 23:14:06,572 - INFO - Couche enc1.0.bias: mean=0.000287, std=0.003761, min=-0.009951, max=0.011699, near_zero=0.00%
2025-06-04 23:14:06,573 - INFO - Couche enc1.1.weight: mean=0.988671, std=0.008153, min=0.966205, max=1.007721, near_zero=0.00%
2025-06-04 23:14:06,573 - INFO - Couche enc1.1.bias: mean=-0.001433, std=0.006026, min=-0.016379, max=0.010532, near_zero=0.00%
2025-06-04 23:14:06,577 - INFO - Couche enc1.3.weight: mean=0.000381, std=0.057746, min=-0.222635, max=0.235539, near_zero=0.00%
2025-06-04 23:14:06,577 - INFO - Couche enc1.3.bias: mean=0.000065, std=0.000839, min=-0.002321, max=0.002330, near_zero=0.00%
2025-06-04 23:14:06,578 - INFO - Couche enc1.4.weight: mean=0.991329, std=0.010486, min=0.961173, max=1.011039, near_zero=0.00%
2025-06-04 23:14:06,578 - INFO - Couche enc1.4.bias: mean=-0.000899, std=0.006566, min=-0.015774, max=0.017829, near_zero=0.00%
2025-06-04 23:14:06,579 - INFO - Couche enc2.0.weight: mean=0.000258, std=0.038167, min=-0.179311, max=0.162598, near_zero=0.00%
2025-06-04 23:14:06,579 - INFO - Couche enc2.0.bias: mean=-0.000009, std=0.000069, min=-0.000254, max=0.000270, near_zero=3.91%
2025-06-04 23:14:06,579 - WARNING - Couche enc2.0.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,580 - INFO - Couche enc2.1.weight: mean=0.936716, std=0.027326, min=0.876741, max=1.004463, near_zero=0.00%
2025-06-04 23:14:06,580 - INFO - Couche enc2.1.bias: mean=-0.004267, std=0.007788, min=-0.023072, max=0.013908, near_zero=0.00%
2025-06-04 23:14:06,581 - INFO - Couche enc2.3.weight: mean=0.000777, std=0.035645, min=-0.171000, max=0.164414, near_zero=0.00%
2025-06-04 23:14:06,581 - INFO - Couche enc2.3.bias: mean=-0.000003, std=0.000030, min=-0.000100, max=0.000100, near_zero=6.25%
2025-06-04 23:14:06,582 - WARNING - Couche enc2.3.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,582 - INFO - Couche enc2.4.weight: mean=0.933470, std=0.023476, min=0.882371, max=0.985703, near_zero=0.00%
2025-06-04 23:14:06,582 - INFO - Couche enc2.4.bias: mean=-0.003767, std=0.006490, min=-0.019657, max=0.011967, near_zero=0.00%
2025-06-04 23:14:06,583 - INFO - Couche enc3.0.weight: mean=0.000143, std=0.020201, min=-0.126057, max=0.108370, near_zero=0.01%
2025-06-04 23:14:06,584 - INFO - Couche enc3.0.bias: mean=0.000000, std=0.000003, min=-0.000010, max=0.000017, near_zero=67.97%
2025-06-04 23:14:06,584 - WARNING - Couche enc3.0.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,584 - INFO - Couche enc3.1.weight: mean=0.883439, std=0.013545, min=0.865399, max=0.937085, near_zero=0.00%
2025-06-04 23:14:06,584 - INFO - Couche enc3.1.bias: mean=-0.005575, std=0.005856, min=-0.018917, max=0.016997, near_zero=0.00%
2025-06-04 23:14:06,587 - INFO - Couche enc3.3.weight: mean=0.000302, std=0.015630, min=-0.107283, max=0.099845, near_zero=0.01%
2025-06-04 23:14:06,588 - INFO - Couche enc3.3.bias: mean=0.000000, std=0.000001, min=-0.000007, max=0.000005, near_zero=82.81%
2025-06-04 23:14:06,588 - WARNING - Couche enc3.3.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,588 - INFO - Couche enc3.4.weight: mean=0.881074, std=0.012870, min=0.866294, max=0.926942, near_zero=0.00%
2025-06-04 23:14:06,589 - INFO - Couche enc3.4.bias: mean=-0.006418, std=0.005370, min=-0.020235, max=0.011967, near_zero=0.00%
2025-06-04 23:14:06,594 - INFO - Couche enc4.0.weight: mean=0.000207, std=0.005437, min=-0.056589, max=0.054239, near_zero=0.04%
2025-06-04 23:14:06,595 - INFO - Couche enc4.0.bias: mean=-0.000000, std=0.000000, min=-0.000000, max=0.000000, near_zero=100.00%
2025-06-04 23:14:06,595 - WARNING - Couche enc4.0.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,596 - INFO - Couche enc4.1.weight: mean=0.867746, std=0.001510, min=0.865607, max=0.879835, near_zero=0.00%
2025-06-04 23:14:06,596 - INFO - Couche enc4.1.bias: mean=0.000619, std=0.002358, min=-0.004892, max=0.009409, near_zero=0.00%
2025-06-04 23:14:06,606 - INFO - Couche enc4.3.weight: mean=-0.000078, std=0.002983, min=-0.035883, max=0.042955, near_zero=0.08%
2025-06-04 23:14:06,607 - INFO - Couche enc4.3.bias: mean=0.000000, std=0.000000, min=-0.000000, max=0.000000, near_zero=100.00%
2025-06-04 23:14:06,607 - WARNING - Couche enc4.3.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,608 - INFO - Couche enc4.4.weight: mean=0.866951, std=0.000859, min=0.865105, max=0.870501, near_zero=0.00%
2025-06-04 23:14:06,608 - INFO - Couche enc4.4.bias: mean=0.000311, std=0.002189, min=-0.007645, max=0.005963, near_zero=0.00%
2025-06-04 23:14:06,609 - INFO - Couche upconv3.weight: mean=-0.000083, std=0.004848, min=-0.024492, max=0.023575, near_zero=0.02%
2025-06-04 23:14:06,609 - INFO - Couche upconv3.bias: mean=-0.000077, std=0.003801, min=-0.009740, max=0.008574, near_zero=0.00%
2025-06-04 23:14:06,613 - INFO - Couche dec3.0.weight: mean=0.000388, std=0.009398, min=-0.075317, max=0.088032, near_zero=0.01%
2025-06-04 23:14:06,615 - INFO - Couche dec3.0.bias: mean=0.000000, std=0.000000, min=-0.000001, max=0.000001, near_zero=99.22%
2025-06-04 23:14:06,615 - WARNING - Couche dec3.0.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,616 - INFO - Couche dec3.1.weight: mean=0.874977, std=0.006629, min=0.865326, max=0.903775, near_zero=0.00%
2025-06-04 23:14:06,616 - INFO - Couche dec3.1.bias: mean=-0.001382, std=0.004436, min=-0.013789, max=0.009556, near_zero=0.00%
2025-06-04 23:14:06,618 - INFO - Couche dec3.3.weight: mean=0.000028, std=0.013844, min=-0.078178, max=0.084411, near_zero=0.01%
2025-06-04 23:14:06,619 - INFO - Couche dec3.3.bias: mean=-0.000000, std=0.000000, min=-0.000001, max=0.000002, near_zero=97.27%
2025-06-04 23:14:06,619 - WARNING - Couche dec3.3.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,620 - INFO - Couche dec3.4.weight: mean=0.881713, std=0.009433, min=0.866893, max=0.915281, near_zero=0.00%
2025-06-04 23:14:06,628 - INFO - Couche dec3.4.bias: mean=0.000296, std=0.004368, min=-0.009872, max=0.014723, near_zero=0.00%
2025-06-04 23:14:06,629 - INFO - Couche upconv2.weight: mean=0.000093, std=0.020685, min=-0.053438, max=0.057358, near_zero=0.00%
2025-06-04 23:14:06,630 - INFO - Couche upconv2.bias: mean=-0.001849, std=0.017048, min=-0.034546, max=0.037973, near_zero=0.00%
2025-06-04 23:14:06,631 - INFO - Couche dec2.0.weight: mean=0.000383, std=0.032697, min=-0.155038, max=0.155799, near_zero=0.00%
2025-06-04 23:14:06,632 - INFO - Couche dec2.0.bias: mean=0.000002, std=0.000014, min=-0.000032, max=0.000084, near_zero=17.19%
2025-06-04 23:14:06,632 - WARNING - Couche dec2.0.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,632 - INFO - Couche dec2.1.weight: mean=0.939886, std=0.020440, min=0.896877, max=0.985839, near_zero=0.00%
2025-06-04 23:14:06,633 - INFO - Couche dec2.1.bias: mean=-0.001432, std=0.005282, min=-0.015337, max=0.014343, near_zero=0.00%
2025-06-04 23:14:06,634 - INFO - Couche dec2.3.weight: mean=-0.000667, std=0.037188, min=-0.168100, max=0.155361, near_zero=0.00%
2025-06-04 23:14:06,634 - INFO - Couche dec2.3.bias: mean=-0.000004, std=0.000029, min=-0.000074, max=0.000113, near_zero=9.38%
2025-06-04 23:14:06,635 - WARNING - Couche dec2.3.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,635 - INFO - Couche dec2.4.weight: mean=0.956138, std=0.012322, min=0.927587, max=0.989958, near_zero=0.00%
2025-06-04 23:14:06,635 - INFO - Couche dec2.4.bias: mean=-0.003786, std=0.004641, min=-0.020638, max=0.010588, near_zero=0.00%
2025-06-04 23:14:06,636 - INFO - Couche upconv1.weight: mean=0.000478, std=0.035161, min=-0.072331, max=0.072234, near_zero=0.01%
2025-06-04 23:14:06,636 - INFO - Couche upconv1.bias: mean=0.003511, std=0.035974, min=-0.061951, max=0.069242, near_zero=0.00%
2025-06-04 23:14:06,637 - INFO - Couche dec1.0.weight: mean=0.000120, std=0.057301, min=-0.243799, max=0.257458, near_zero=0.00%
2025-06-04 23:14:06,637 - INFO - Couche dec1.0.bias: mean=0.000080, std=0.000646, min=-0.001595, max=0.002104, near_zero=1.56%
2025-06-04 23:14:06,637 - INFO - Couche dec1.1.weight: mean=0.991831, std=0.010575, min=0.959383, max=1.019638, near_zero=0.00%
2025-06-04 23:14:06,637 - INFO - Couche dec1.1.bias: mean=-0.002149, std=0.006580, min=-0.017146, max=0.011526, near_zero=0.00%
2025-06-04 23:14:06,638 - INFO - Couche dec1.3.weight: mean=-0.000028, std=0.057908, min=-0.250498, max=0.223584, near_zero=0.00%
2025-06-04 23:14:06,639 - INFO - Couche dec1.3.bias: mean=0.000062, std=0.000887, min=-0.003007, max=0.004117, near_zero=1.56%
2025-06-04 23:14:06,639 - INFO - Couche dec1.4.weight: mean=0.992944, std=0.009565, min=0.935390, max=1.000028, near_zero=0.00%
2025-06-04 23:14:06,639 - INFO - Couche dec1.4.bias: mean=-0.002880, std=0.004013, min=-0.026787, max=0.001141, near_zero=0.00%
2025-06-04 23:14:06,640 - INFO - Couche final_conv.weight: mean=-0.001320, std=0.249697, min=-0.925628, max=0.792349, near_zero=0.00%
2025-06-04 23:14:06,640 - INFO - Couche final_conv.bias: mean=0.000176, std=0.000938, min=-0.001023, max=0.001007, near_zero=0.00%
2025-06-04 23:14:06,640 - INFO - Couche final_conv_e2.weight: mean=-0.007154, std=0.247219, min=-1.156590, max=0.880002, near_zero=0.00%
2025-06-04 23:14:06,641 - INFO - Couche final_conv_e2.bias: mean=0.000000, std=0.000000, min=0.000000, max=0.000000, near_zero=100.00%
2025-06-04 23:14:06,641 - WARNING - Couche final_conv_e2.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,641 - INFO - Couche final_conv_e3.weight: mean=0.000531, std=0.247181, min=-0.849403, max=0.850165, near_zero=0.00%
2025-06-04 23:14:06,641 - INFO - Couche final_conv_e3.bias: mean=0.000000, std=0.000000, min=0.000000, max=0.000000, near_zero=100.00%
2025-06-04 23:14:06,642 - WARNING - Couche final_conv_e3.bias: Variance très faible, possible problème d'initialisation ou d'apprentissage
2025-06-04 23:14:06,642 - INFO - Couche classifier.2.weight: mean=0.205341, std=1.147529, min=-2.137789, max=2.847555, near_zero=0.00%
2025-06-04 23:14:06,644 - INFO - Couche classifier.2.bias: mean=0.000937, std=nan, min=0.000937, max=0.000937, near_zero=0.00%
2025-06-04 23:14:06,644 - INFO - Analyse de la couche de sortie...
2025-06-04 23:14:06,645 - WARNING - La couche de sortie classifier.2.weight a un biais positif (favorise la classe IA)
2025-06-04 23:14:06,695 - INFO - Trouvé 554 tuiles
2025-06-04 23:14:06,711 - INFO - Dataset créé avec 554 tuiles
2025-06-04 23:14:06,711 - INFO - Analyse du dataset...
2025-06-04 23:14:07,111 - INFO - Distribution des classes: {np.float64(0.0): np.int64(214), np.float64(1.0): np.int64(340)}
2025-06-04 23:14:07,112 - INFO - Tuiles par matrice - Moyenne: 1.07, Std: 0.27, Min: 1, Max: 3
2025-06-04 23:14:07,112 - WARNING - 516 matrices ont moins de 3 tuiles, ce qui peut affecter l'agrégation
2025-06-04 23:14:07,112 - INFO - Visualisation des prédictions sur un échantillon...
2025-06-04 23:14:07,313 - INFO - Exemple 18: Matrice 15, Label=1.0, Prédiction=0.670599
2025-06-04 23:14:07,350 - INFO - Exemple 216: Matrice 203, Label=1.0, Prédiction=0.670637
2025-06-04 23:14:07,388 - INFO - Exemple 263: Matrice 246, Label=1.0, Prédiction=0.675332
2025-06-04 23:14:07,427 - INFO - Exemple 517: Matrice 481, Label=0.0, Prédiction=0.670848
2025-06-04 23:14:07,464 - INFO - Exemple 250: Matrice 233, Label=1.0, Prédiction=0.671171
2025-06-04 23:14:07,503 - INFO - Exemple 341: Matrice 312, Label=0.0, Prédiction=0.675413
2025-06-04 23:14:07,540 - INFO - Exemple 363: Matrice 334, Label=0.0, Prédiction=0.672185
2025-06-04 23:14:07,580 - INFO - Exemple 441: Matrice 410, Label=0.0, Prédiction=0.671590
2025-06-04 23:14:07,618 - INFO - Exemple 93: Matrice 81, Label=1.0, Prédiction=0.671066
2025-06-04 23:14:07,658 - INFO - Exemple 322: Matrice 297, Label=1.0, Prédiction=0.671315
2025-06-04 23:14:07,698 - INFO - Exemple 513: Matrice 477, Label=0.0, Prédiction=0.670214
2025-06-04 23:14:07,741 - INFO - Exemple 131: Matrice 118, Label=1.0, Prédiction=0.670700
2025-06-04 23:14:07,782 - INFO - Exemple 84: Matrice 72, Label=1.0, Prédiction=0.670655
2025-06-04 23:14:07,822 - INFO - Exemple 448: Matrice 417, Label=0.0, Prédiction=0.671574
2025-06-04 23:14:07,863 - INFO - Exemple 450: Matrice 419, Label=0.0, Prédiction=0.670434
2025-06-04 23:14:07,906 - INFO - Exemple 438: Matrice 407, Label=0.0, Prédiction=0.670184
2025-06-04 23:14:07,945 - INFO - Exemple 118: Matrice 106, Label=1.0, Prédiction=0.671582
2025-06-04 23:14:07,984 - INFO - Exemple 21: Matrice 17, Label=1.0, Prédiction=0.674699
2025-06-04 23:14:08,025 - INFO - Exemple 521: Matrice 485, Label=0.0, Prédiction=0.669943
2025-06-04 23:14:08,069 - INFO - Exemple 103: Matrice 91, Label=1.0, Prédiction=0.670348
2025-06-04 23:14:08,947 - INFO - Graphique des prédictions enregistré dans 'predictions_sample.png'
2025-06-04 23:14:08,948 - INFO - Évaluation sur l'ensemble du dataset...
2025-06-04 23:14:24,270 - INFO - AUC-ROC: 0.6357
2025-06-04 23:14:24,270 - INFO - AUC-PR: 0.7267
2025-06-04 23:14:24,271 - INFO - Seuil optimal (basé sur ROC): 0.6708
2025-06-04 23:14:24,271 - INFO - Accuracy avec seuil standard (0.5): 0.6137
2025-06-04 23:14:24,272 - INFO - Accuracy avec seuil optimal (0.6708): 0.6119
2025-06-04 23:14:24,279 - INFO - Accuracy au niveau des matrices: 0.6004
2025-06-04 23:14:24,501 - INFO - Courbes ROC et PR enregistrées dans 'roc_pr_curves.png'
2025-06-04 23:14:24,695 - INFO - Histogrammes des prédictions enregistrés dans 'prediction_histograms.png'
2025-06-04 23:14:24,698 - INFO - Diagnostic terminé. Résultats enregistrés dans .\diagnostics\
2025-06-04 23:14:24,699 - INFO - Résumé: AUC-ROC=0.6357, Accuracy=0.6137
2025-06-04 23:14:24,699 - WARNING - PROBLÈME DÉTECTÉ: Accuracy proche de la distribution majoritaire, le modèle pourrait prédire toujours la même classe
2025-06-04 23:14:24,699 - INFO - 
=== SUGGESTIONS D'AMÉLIORATION ===
2025-06-04 23:14:24,699 - INFO - 2. Ajuster le seuil de décision à 0.6708 au lieu de 0.5
2025-06-04 23:14:24,699 - INFO - 3. Problème potentiel d'évanouissement du gradient, essayer:
2025-06-04 23:14:24,700 - INFO -    - Réduire la profondeur du réseau
2025-06-04 23:14:24,700 - INFO -    - Utiliser des connexions résiduelles
2025-06-04 23:14:24,700 - INFO -    - Modifier l'initialisation des poids
2025-06-04 23:14:24,700 - INFO - 4. Essayer une architecture plus simple (CNN standard)
2025-06-04 23:14:24,700 - INFO - 5. Augmenter la régularisation (dropout, weight decay)
2025-06-04 23:14:24,700 - INFO - 6. Vérifier le prétraitement des données

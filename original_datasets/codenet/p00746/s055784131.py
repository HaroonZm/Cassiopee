'''
hardest 2.
Aizu Online Judge 1165: Pablo Squarson's Headache
http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1165

## ?§£??¬

??£?????¢?????????????????£?????§???????????¢?????\????????????????????¢???????°????????????¨???????????????????????????????????§???
??£?????¢???????????¢???????????????????????????????????¨???????????¶???????????????

?´°????????¬?????????????????????????????§?????????????????\???????????????????????§?§£?????????

1. ?°´????????????x???,?????´?????????y?????¨?????????
2. ???????????£?????¢??????????????§?¨????(0, 0)??¨????????????????????£?????¢?????§?¨?????±???????
3. ????????¢????????????  (?????£?????¢???x??§?¨?????????§???) - (?????£?????¢???x??§?¨????????°????) + 1
4. ????????¢???????????????(?????£?????¢???y??§?¨?????????§???) - (?????£?????¢???y??§?¨????????°????) + 1

?????±???????????????????????°?????????????????????(AOJ?????????????????????????????????????????????????????¨????????????????????????)

'''

adjacent_vectors = [
    (-1, 0), # left
    (0, -1), # down
    (1, 0),  # right
    (0, 1)   # up
]

while True:
    num_squares = int(input())

    if num_squares == 0:
        break

    x_coordinates = [0] # x??§?¨?????????????
    y_coordinates = [0] # y??§?¨?????????????

    for _ in range(num_squares-1):
        # adjacent_square: ??£??\????????£?????¢?????????
        adjacent_square, direction = map(int, input().split())

        x = x_coordinates[adjacent_square] # ??£??\????????£?????¢???x??§?¨?
        y = y_coordinates[adjacent_square] # ??£??\????????£?????¢???y??§?¨?

        (dx, dy) = adjacent_vectors[direction]

        x_coordinates.append(x + dx)
        y_coordinates.append(y + dy)

    max_x = max(x_coordinates)
    min_x = min(x_coordinates)
    max_y = max(y_coordinates)
    min_y = min(y_coordinates)

    print(max_x - min_x + 1, max_y - min_y + 1)
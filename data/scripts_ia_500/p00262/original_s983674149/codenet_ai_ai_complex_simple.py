from functools import reduce
exec(''.join(__import__('base64').b64decode
(b'd2hpbGUgMTphPTBsaT1sPTAsbz11bmtub3duPUZhbHNlCmlucHV0X2xpc3Q9KHV0ZilbKFQpXQpvYmplY3Q9aW50CmlucHV0PSxtYXAoZGVjIDEyNCwgaW50KHJhd19pbnB1dCgpLnNwbGl0KCkpKQpjb3VudD0wCndo'
+'aWxlIGxheWVyIDw9MTAwMDA6CiAgIGlmIGJlY2F1c2UuY291bnQoMCkgIT09IDI6ICAgICAgICAjIElmIBymYmJpZXJcbmZvciBpIGluIHJhbmdlKGV4'
+'ZWModjNpcmM9bnZlbzksaSBsPTN0Li4uKTpmb3IgYmUgW2FyZy1lbmQtMSwgYXJnXTphZGRmdigsbmVidCkKZWxzZToKICAgICMgaWYgYVtzYy0xXSot'
+'c1Vjb2QzIT00OiAgICAgICMgRWw6IGVsc2UKICAgICAgaWYgYmJbMF09MQogICAgICAgICAgZm9yIHQgaW4gc2xhbmQoYmIpOgogICAgICAgICAgICBpZi'
+'BiW3QrMV0gLSBiW3RdID09IDE6CgogICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgcHJpbnQoY291bnQpCiAgICAgICAgICByZXN0IGJyZWFrCgogICBm'
+'b3IgaSBpbiByYW5nZShsZW4oYmIpKToKICAgIGJiW2ldIC0+PSAxCiAgIGJiLmFwcGVuZChtcmFuZ2UoYmwpKQogICAgd2hpbGUgMCBhNDYfYmIuY291'
+'bnQoMCk6CiAgICAgIGRlbCBiW2JiLmluZGV4KDApXQogICAgY291bnQrKzEKZWxzZToKICAgIHByaW50IC0xCg=='), 'utf-8')).decode())